<html lang="zh-CN">
<head>
  <title>Demo</title>
  <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"/>
  <meta charset="utf-8"/>
  <script src="http://192.168.137.152:15678/web-apps/apps/api/documents/api.js"></script>
  <style>
    body {
      padding: 0;
      margin: 0;
    }
  </style>
</head>
<body>
<div id="placeholder"></div>
<script>
    /**
     * 详细配置文档：https://api.onlyoffice.com/editors/config/
     * @param url 要预览的文档地址
     * @param filename 要预览的文档文件名   zLyzkuxEyivbDFjn8zYXkqNLGPh8fN2J
     */
    function preview(url, filename) {
        const index = filename.lastIndexOf('.');
        const fileType = filename.substr(index + 1);
        const config = {
            "document": {
                "permissions": {
                    comment: false,
                    fillForms: false,
                    "edit": false,
                },
                "fileType": fileType,
                "title": filename,
                "url": url,
                // "key": this.md5,
                "lang": "zh-CN"
            },
            "width": '100%',
            "editorConfig": {
                mode: 'view',
                "lang": "zh-CN"
            }
        };
        document.title = filename;
        const docEditor = new DocsAPI.DocEditor("placeholder", config);
    }

    // 要预览的文档地址
    const url = 'http://127.0.0.1/mycloud/file/download/17129987751687';
    // 要预览的文档文件名
    const filename = '开题报告.docx';
    // 调用方法
    preview(url, filename);
</script>
</body>
</html>

